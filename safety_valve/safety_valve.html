<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å£“åŠ›å®¹å™¨å®‰å…¨é–¥æ¼”ç¤º</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* è‡ªå®šç¾©è’¸æ°£å‹•ç•«ç‰¹æ•ˆ */
        @keyframes blow-heavy {
            0% { transform: translate(0, 0) scale(0.5); opacity: 0; }
            10% { opacity: 0.9; }
            100% { transform: translate(180px, -40px) scale(3); opacity: 0; }
        }
        @keyframes blow-light {
            0% { transform: translate(0, 0) scale(0.3); opacity: 0; }
            20% { opacity: 0.5; }
            100% { transform: translate(80px, -10px) scale(1.5); opacity: 0; }
        }
        
        .steam-heavy { animation: blow-heavy 0.8s infinite linear; }
        .steam-light { animation: blow-light 1.2s infinite linear; }
        
        /* è®“ä¸åŒè’¸æ°£ç²’å­æœ‰ä¸åŒçš„å»¶é²æ™‚é–“ï¼Œç”¢ç”Ÿé€£çºŒå™´å°„æ„Ÿ */
        .delay-1 { animation-delay: 0.1s; }
        .delay-2 { animation-delay: 0.2s; }
        .delay-3 { animation-delay: 0.3s; }
        .delay-4 { animation-delay: 0.4s; }
        .delay-5 { animation-delay: 0.5s; }
        .delay-6 { animation-delay: 0.6s; }
        .delay-7 { animation-delay: 0.7s; }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 24px;
            width: 24px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            margin-top: -8px;
            box-shadow: 0 0 5px rgba(0,0,0,0.3);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 8px;
            cursor: pointer;
            background: #e2e8f0;
            border-radius: 4px;
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen font-sans text-slate-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- å®‰å…¨é–¥è¨­å®šå¸¸æ•¸ ---
        const MAX_PRESSURE = 120;
        const SET_PRESSURE = 100;     // è¨­å®šå£“åŠ› (èµ·è·³å£“åŠ›)
        const SIMMER_PRESSURE = 95;   // åˆå™´å£“åŠ› (å¾®å•Ÿ)
        const RESEAT_PRESSURE = 85;   // å›åº§å£“åŠ› (åœå™´)

        const App = () => {
            const [pressure, setPressure] = useState(50);
            const [valveState, setValveState] = useState('CLOSED'); // 'CLOSED', 'SIMMERING', 'OPEN'

            // å®‰å…¨é–¥ä½œå‹•é‚è¼¯ (åŒ…å«é²æ»¯æ•ˆæ‡‰ Hysteresis / Blowdown)
            useEffect(() => {
                if (valveState === 'CLOSED') {
                    if (pressure >= SET_PRESSURE) setValveState('OPEN');
                    else if (pressure >= SIMMER_PRESSURE) setValveState('SIMMERING');
                } else if (valveState === 'SIMMERING') {
                    if (pressure >= SET_PRESSURE) setValveState('OPEN');
                    else if (pressure < SIMMER_PRESSURE) setValveState('CLOSED');
                } else if (valveState === 'OPEN') {
                    // ä¸€æ—¦å…¨é–‹ï¼Œå¿…é ˆç­‰åˆ°å£“åŠ›é™è‡³ã€Œå›åº§å£“åŠ›ã€ä»¥ä¸‹æ‰æœƒé—œé–‰
                    if (pressure <= RESEAT_PRESSURE) setValveState('CLOSED');
                }
            }, [pressure, valveState]);

            // è¨ˆç®—é–¥ç“£ (Disc) ä½ç§»
            const discOffset = useMemo(() => {
                if (valveState === 'OPEN') return -45; // å…¨é–‹é«˜åº¦
                if (valveState === 'SIMMERING') return -6; // å¾®å•Ÿé«˜åº¦
                return 0; // é—œé–‰
            }, [valveState]);

            // è¨ˆç®—æŒ‡é‡è§’åº¦ (270åº¦è¦–è§’ï¼Œå¾ -135 åˆ° +135)
            const gaugeAngle = (pressure / MAX_PRESSURE) * 270 - 135;

            // å‹•æ…‹ç”¢ç”Ÿå½ˆç°§çš„ SVG Path
            const generateSpringPath = (offset) => {
                const startY = 120; // é ‚éƒ¨å›ºå®šé»
                const endY = 250 + offset; // åº•éƒ¨éš¨é–¥ç“£ç§»å‹•
                const coils = 6;
                const width = 36;
                const centerX = 250;
                const step = (endY - startY) / (coils * 2);
                
                let d = `M ${centerX} ${startY} `;
                for(let i=0; i<coils; i++) {
                    d += `L ${centerX - width/2} ${startY + step * (i*2 + 0.5)} `;
                    d += `L ${centerX + width/2} ${startY + step * (i*2 + 1.5)} `;
                }
                d += `L ${centerX} ${endY}`;
                return d;
            };

            // å£“åŠ›å®¹å™¨å…§éƒ¨é¡è‰² (å£“åŠ›è¶Šé«˜è¶Šç´…)
            const vesselColor = useMemo(() => {
                const ratio = pressure / MAX_PRESSURE;
                const r = Math.min(255, 100 + ratio * 155);
                const g = Math.max(0, 200 - ratio * 200);
                const b = Math.max(0, 250 - ratio * 250);
                return `rgba(${r}, ${g}, ${b}, 0.6)`;
            }, [pressure]);

            return (
                <div class="max-w-6xl mx-auto p-4 md:p-8 flex flex-col lg:flex-row gap-8">
                    
                    {/* å·¦å´ï¼šSVG è¦–è¦ºæ¼”ç¤ºå€ */}
                    <div class="flex-1 bg-white rounded-2xl shadow-xl overflow-hidden border border-slate-200 flex flex-col">
                        <div class="bg-slate-800 text-white py-3 px-6 text-lg font-bold flex justify-between items-center">
                            <span>å®‰å…¨é–¥å…§éƒ¨ä½œå‹•å‰–é¢åœ–</span>
                            <span className={`px-3 py-1 rounded-full text-sm font-bold ${
                                valveState === 'OPEN' ? 'bg-red-500 text-white' : 
                                valveState === 'SIMMERING' ? 'bg-yellow-400 text-black' : 'bg-emerald-500 text-white'
                            }`}>
                                {valveState === 'OPEN' ? 'å…¨é–‹æ’æ”¾ä¸­' : 
                                 valveState === 'SIMMERING' ? 'åˆå™´å¾®å•Ÿ' : 'å®Œå…¨é—œé–‰'}
                            </span>
                        </div>
                        <div class="p-4 flex-1 flex justify-center items-center bg-slate-50">
                            <svg viewBox="0 0 500 650" className="w-full h-auto max-h-[600px] drop-shadow-md">
                                <defs>
                                    <linearGradient id="vesselGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                                        <stop offset="0%" stopColor="#e2e8f0" />
                                        <stop offset="50%" stopColor="#f8fafc" />
                                        <stop offset="100%" stopColor="#cbd5e1" />
                                    </linearGradient>
                                    <linearGradient id="metalGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                                        <stop offset="0%" stopColor="#94a3b8" />
                                        <stop offset="50%" stopColor="#cbd5e1" />
                                        <stop offset="100%" stopColor="#64748b" />
                                    </linearGradient>
                                </defs>

                                {/* --- 1. å£“åŠ›å®¹å™¨ (Vessel) --- */}
                                <g id="vessel">
                                    {/* å…§éƒ¨å£“åŠ›æ°£é«” */}
                                    <path d="M50 350 L50 600 A 200 50 0 0 0 450 600 L450 350 Z" fill={vesselColor} style={{transition: 'fill 0.3s'}} />
                                    {/* å®¹å™¨å¤–æ®¼ */}
                                    <path d="M50 650 L50 350 A 200 50 0 0 1 450 350 L450 650" fill="none" stroke="#475569" strokeWidth="8" strokeLinecap="round"/>
                                    {/* å™´å˜´/å…¥å£ç®¡ (Nozzle) */}
                                    <rect x="210" y="280" width="80" height="70" fill="url(#metalGrad)" stroke="#334155" strokeWidth="4"/>
                                    {/* å…§éƒ¨æ°£é«”æ³¡æ³¡é»ç¶´ */}
                                    {pressure > 20 && <circle cx="150" cy="450" r="10" fill="#fff" opacity="0.3" />}
                                    {pressure > 50 && <circle cx="350" cy="500" r="15" fill="#fff" opacity="0.3" />}
                                    {pressure > 80 && <circle cx="250" cy="400" r="8"  fill="#fff" opacity="0.4" />}
                                </g>

                                {/* --- 2. å£“åŠ›è¡¨ (Pressure Gauge) --- */}
                                <g id="gauge" transform="translate(100, 480)">
                                    <circle cx="0" cy="0" r="45" fill="#fff" stroke="#334155" strokeWidth="6"/>
                                    <circle cx="0" cy="0" r="38" fill="#f8fafc" />
                                    {/* åˆ»åº¦ */}
                                    <path d="M -25 25 A 35 35 0 1 1 25 25" fill="none" stroke="#94a3b8" strokeWidth="4" strokeDasharray="4 8"/>
                                    {/* ç´…è‰²å±éšªå€é–“åˆ»åº¦ */}
                                    <path d="M 15 -32 A 35 35 0 0 1 25 25" fill="none" stroke="#ef4444" strokeWidth="4"/>
                                    {/* æŒ‡é‡ */}
                                    <g style={{ transform: `rotate(${gaugeAngle}deg)`, transition: 'transform 0.3s cubic-bezier(0.4, 2.5, 0.4, 0.9)' }}>
                                        <line x1="0" y1="5" x2="0" y2="-30" stroke="#ef4444" strokeWidth="4" strokeLinecap="round"/>
                                        <circle cx="0" cy="0" r="5" fill="#1e293b"/>
                                    </g>
                                    <text x="0" y="15" textAnchor="middle" fontSize="10" fill="#475569" fontWeight="bold">PSI</text>
                                </g>

                                {/* --- 3. é–¥é«” (Valve Body) --- */}
                                <g id="valve-body">
                                    {/* é–¥é«”å¤–æ®¼ */}
                                    <path d="M170 100 L330 100 L330 280 L170 280 Z" fill="url(#metalGrad)" stroke="#334155" strokeWidth="4" />
                                    {/* æ’æ”¾å‡ºå£ (Outlet) */}
                                    <rect x="330" y="160" width="90" height="70" fill="url(#metalGrad)" stroke="#334155" strokeWidth="4" />
                                    {/* è“‹æ‰å‡ºå£èˆ‡é–¥é«”äº¤ç•Œçš„ç·š */}
                                    <line x1="330" y1="162" x2="330" y2="228" stroke="url(#metalGrad)" strokeWidth="6" />
                                </g>

                                {/* --- 4. é–¥åº§ (Seat) --- */}
                                <rect x="200" y="270" width="100" height="10" fill="#475569" />

                                {/* --- 5. ç§»å‹•çµ„ä»¶: é–¥ç“£ (Disc) èˆ‡ é–¥æ¡¿ (Stem) --- */}
                                <g style={{ transform: `translateY(${discOffset}px)`, transition: 'transform 0.15s ease-out' }}>
                                    {/* é–¥æ¡¿ */}
                                    <rect x="242" y="120" width="16" height="150" fill="#cbd5e1" stroke="#334155" strokeWidth="2"/>
                                    {/* é–¥ç“£ (Disc) - æ¥è§¸é¢ */}
                                    <path d="M 195 270 L 305 270 L 290 250 L 210 250 Z" fill="#f59e0b" stroke="#b45309" strokeWidth="3"/>
                                    {/* å°å‘å¥— / é–¥ç“£åº§ */}
                                    <rect x="210" y="240" width="80" height="10" fill="#64748b" stroke="#334155" strokeWidth="2"/>
                                </g>

                                {/* --- 6. å½ˆç°§ (Spring) --- */}
                                <path d={generateSpringPath(discOffset)} fill="none" stroke="#0f172a" strokeWidth="8" strokeLinecap="round" strokeLinejoin="round" 
                                      style={{ transition: 'd 0.15s ease-out' }}/>

                                {/* --- 7. é ‚éƒ¨èª¿ç¯€èºçµ² (Adjusting Screw) --- */}
                                <rect x="220" y="80" width="60" height="20" fill="#64748b" stroke="#1e293b" strokeWidth="4"/>
                                <rect x="235" y="50" width="30" height="30" fill="#94a3b8" stroke="#1e293b" strokeWidth="4"/>
                                <rect x="240" y="30" width="20" height="20" fill="#cbd5e1" stroke="#1e293b" strokeWidth="4"/>

                                {/* --- 8. è’¸æ°£æ’æ”¾å‹•ç•« (Steam Effects) --- */}
                                <g id="steam-effects" transform="translate(420, 195)">
                                    {valveState === 'OPEN' && (
                                        <>
                                            <circle cx="0" cy="0" r="15" fill="#94a3b8" className="steam-heavy delay-1" />
                                            <circle cx="0" cy="10" r="12" fill="#cbd5e1" className="steam-heavy delay-2" />
                                            <circle cx="0" cy="-5" r="20" fill="#e2e8f0" className="steam-heavy delay-3" />
                                            <circle cx="0" cy="5" r="16" fill="#f8fafc" className="steam-heavy delay-4" />
                                            <circle cx="0" cy="-10" r="14" fill="#cbd5e1" className="steam-heavy delay-5" />
                                            <circle cx="0" cy="15" r="18" fill="#94a3b8" className="steam-heavy delay-6" />
                                            <circle cx="0" cy="0" r="22" fill="#e2e8f0" className="steam-heavy delay-7" />
                                        </>
                                    )}
                                    {valveState === 'SIMMERING' && (
                                        <>
                                            <circle cx="0" cy="0" r="8" fill="#cbd5e1" className="steam-light delay-1" />
                                            <circle cx="0" cy="10" r="6" fill="#e2e8f0" className="steam-light delay-3" />
                                            <circle cx="0" cy="-5" r="7" fill="#f8fafc" className="steam-light delay-5" />
                                        </>
                                    )}
                                </g>

                            </svg>
                        </div>
                    </div>

                    {/* å³å´ï¼šæ§åˆ¶é¢æ¿èˆ‡è§£èªª */}
                    <div class="flex-1 flex flex-col gap-6">
                        
                        {/* å„€è¡¨æ¿å¡ç‰‡ */}
                        <div class="bg-white p-6 rounded-2xl shadow-lg border border-slate-200">
                            <h2 class="text-2xl font-bold text-slate-800 mb-6 border-b pb-2 flex items-center gap-2">
                                âš™ï¸ æ‰‹å‹•æ§åˆ¶é¢æ¿
                            </h2>
                            
                            <div class="mb-8">
                                <div class="flex justify-between items-end mb-2">
                                    <label class="text-slate-600 font-semibold text-lg">ç³»çµ±å£“åŠ› (System Pressure)</label>
                                    <div class={`text-4xl font-black font-mono transition-colors ${
                                        pressure >= SET_PRESSURE ? 'text-red-600' : 
                                        pressure >= SIMMER_PRESSURE ? 'text-orange-500' : 'text-blue-600'
                                    }`}>
                                        {pressure.toFixed(1)} <span class="text-lg text-slate-500">PSI</span>
                                    </div>
                                </div>
                                <input 
                                    type="range" 
                                    min="0" 
                                    max={MAX_PRESSURE} 
                                    step="0.5" 
                                    value={pressure}
                                    onChange={(e) => setPressure(parseFloat(e.target.value))}
                                    class="w-full h-4 bg-slate-200 rounded-lg appearance-none cursor-pointer"
                                />
                                <div class="flex justify-between text-xs text-slate-400 mt-2 font-mono">
                                    <span>0</span>
                                    <span>{RESEAT_PRESSURE} (å›åº§)</span>
                                    <span>{SET_PRESSURE} (èµ·è·³)</span>
                                    <span>{MAX_PRESSURE}</span>
                                </div>
                            </div>

                            <div class="bg-slate-50 rounded-xl p-4 border border-slate-200">
                                <h3 class="font-bold text-slate-700 mb-3">ç•¶å‰å®‰å…¨é–¥ç‹€æ…‹</h3>
                                
                                {valveState === 'CLOSED' && (
                                    <div class="flex items-start gap-3 text-emerald-700 bg-emerald-50 p-3 rounded-lg border border-emerald-200">
                                        <div class="mt-1 text-2xl">ğŸŸ¢</div>
                                        <div>
                                            <div class="font-bold text-lg">é—œé–‰ (Closed)</div>
                                            <p class="text-sm mt-1">ç³»çµ±å£“åŠ›æ­£å¸¸ã€‚å½ˆç°§çš„ä¸‹å£“åŠ›é‡å¤§æ–¼å®¹å™¨å…§éƒ¨å‘ä¸Šçš„ä»‹è³ªå£“åŠ›ï¼Œé–¥ç“£ç·Šå£“åœ¨é–¥åº§ä¸Šï¼Œä¿æŒå¯†å°ã€‚</p>
                                        </div>
                                    </div>
                                )}

                                {valveState === 'SIMMERING' && (
                                    <div class="flex items-start gap-3 text-orange-700 bg-orange-50 p-3 rounded-lg border border-orange-200">
                                        <div class="mt-1 text-2xl">ğŸŸ¡</div>
                                        <div>
                                            <div class="font-bold text-lg">åˆå™´ / å¾®å•Ÿ (Simmering)</div>
                                            <p class="text-sm mt-1">å£“åŠ›æ¥è¿‘è¨­å®šå€¼ ({SIMMER_PRESSURE}~{SET_PRESSURE} PSI)ã€‚å‘ä¸Šå£“åŠ›å¹¾ä¹æŠµéŠ·å½ˆç°§åŠ›ï¼Œé–¥ç“£å¾®å¹…æŠ¬èµ·ï¼Œå°é‡æ°£é«”æ´©æ¼ä¸¦ç™¼å‡ºå˜¶å˜¶è²ã€‚</p>
                                        </div>
                                    </div>
                                )}

                                {valveState === 'OPEN' && (
                                    <div class="flex items-start gap-3 text-red-700 bg-red-50 p-3 rounded-lg border border-red-200">
                                        <div class="mt-1 text-2xl animate-pulse">ğŸ”´</div>
                                        <div>
                                            <div class="font-bold text-lg">æ’æ”¾ / èµ·è·³ (Popping/Blowing)</div>
                                            <p class="text-sm mt-1">å£“åŠ›é”åˆ°æˆ–è¶…éè¨­å®šå£“åŠ› ({SET_PRESSURE} PSI)ï¼é–¥é–€ç¬é–“å…¨é–‹ï¼Œå¤§é‡ä»‹è³ªé«˜é€Ÿæ’å‡ºä»¥ä¿è­·å®¹å™¨ã€‚<b>æ³¨æ„ï¼šå¿…é ˆç­‰å£“åŠ›é™è‡³ {RESEAT_PRESSURE} PSI ä»¥ä¸‹æ‰æœƒé‡æ–°é—œé–‰ã€‚</b></p>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* æ•™å­¸èªªæ˜å¡ç‰‡ */}
                        <div class="bg-white p-6 rounded-2xl shadow-lg border border-slate-200 flex-1">
                            <h2 class="text-xl font-bold text-slate-800 mb-4 border-b pb-2">ğŸ“– ä½œå‹•åŸç†èˆ‡åƒæ•¸è¨­å®š</h2>
                            <ul class="space-y-4 text-slate-600 text-sm leading-relaxed">
                                <li class="flex gap-2">
                                    <span class="font-bold min-w-max text-slate-800">è¨­å®šå£“åŠ› (Set Pressure)ï¼š</span>
                                    <span>ç›®å‰è¨­å®šç‚º <b class="text-red-600">{SET_PRESSURE} PSI</b>ã€‚ç•¶ç³»çµ±é”åˆ°æ­¤å£“åŠ›æ™‚ï¼Œé–¥é–€æœƒã€Œèµ·è·³ã€å®Œå…¨æ‰“é–‹ã€‚å¯é€éé ‚éƒ¨èºçµ²èª¿æ•´å½ˆç°§é å£“ä¾†æ”¹è®Šæ­¤å€¼ã€‚</span>
                                </li>
                                <li class="flex gap-2">
                                    <span class="font-bold min-w-max text-slate-800">å›åº§å£“åŠ› (Reseat Pressure)ï¼š</span>
                                    <span>ç›®å‰è¨­å®šç‚º <b class="text-blue-600">{RESEAT_PRESSURE} PSI</b>ã€‚é–¥é–€é–‹å•Ÿå¾Œï¼Œç”±æ–¼æ°£é«”å‹•åŠ›å­¸(åè¡ç›¤ä½œç”¨)ï¼Œå¿…é ˆå°‡å£“åŠ›é™è‡³ä½æ–¼è¨­å®šå£“åŠ›ä¸€æ®µè·é›¢å¾Œï¼Œé–¥é–€æ‰èƒ½é‡æ–°é—œé–‰ã€‚</span>
                                </li>
                                <li class="flex gap-2">
                                    <span class="font-bold min-w-max text-slate-800">å•Ÿé–‰å£“å·® (Blowdown)ï¼š</span>
                                    <span>è¨­å®šå£“åŠ›èˆ‡å›åº§å£“åŠ›çš„å·®å€¼ ({SET_PRESSURE} - {RESEAT_PRESSURE} = 15 PSI)ã€‚é€™æ˜¯ä¸€ç¨®è¨­è¨ˆä¸Šçš„ã€Œé²æ»¯æ•ˆæ‡‰ã€ï¼Œèƒ½é˜²æ­¢é–¥é–€åœ¨è¨­å®šé»é™„è¿‘é »ç¹é–‹é—œï¼ˆéœ‡é¡«/Chatteringï¼‰å°è‡´æå£ã€‚</span>
                                </li>
                            </ul>
                            
                            <div class="mt-6 p-4 bg-blue-50 text-blue-800 rounded-lg text-sm border border-blue-100">
                                <b>ğŸ’¡ äº’å‹•æç¤ºï¼š</b><br/>
                                æ…¢æ…¢å°‡æ‹‰æ¡¿å‘å³æ‹‰ï¼Œè§€å¯Ÿé–¥é–€åœ¨ {SIMMER_PRESSURE} PSI æ™‚çš„ã€Œåˆå™´ã€ä»¥åŠ {SET_PRESSURE} PSI æ™‚çš„ç¬é–“ã€Œèµ·è·³å…¨é–‹ã€ã€‚æ¥è‘—å°‡æ‹‰æ¡¿å¾€å·¦æ‹‰ï¼Œä½ æœƒç™¼ç¾å³ä½¿ä½æ–¼ 100 PSI é–¥é–€ä¾ç„¶ä¿æŒé–‹å•Ÿï¼Œç›´åˆ°é™ç ´ {RESEAT_PRESSURE} PSI æ‰æœƒã€Œå›åº§ã€é—œé–‰ã€‚
                            </div>
                        </div>

                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
